<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>https://www.cnblogs.com/SamWeb/p/8417940.html</title>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://cdn.staticfile.org/babel-polyfill/7.0.0-beta.54/polyfill.min.js"></script>
    <script>
        // async 异步 非同步 
        // 如果async 函数中有返回一个值 ,当调用该函数时，内部会调用Promise.solve() 方法把它转化成一个promise 对象作为返回
        // async function timeout() {

        //     return 'hello world'
        // }
        // console.log(timeout())
        // timeout().then(result => {
        //     console.log(result)
        // })
        // console.log("虽然我在后边但是我先执行")






        // await 后面放置的就是返回promise对象的一个表达式
        // 它里面遇到了await, await 表示等一下，代码就暂停到这里，不再向下执行了，它等什么呢？等后面的promise对象执行完毕，然后拿到promise resolve 的值并进行返回，返回值拿到之后，它继续向下执行。

        // 2s 之后返回双倍的值
        // function doubleAfter2seconds(num) {
        //     return new Promise((resolve, reject) => {
        //         setTimeout(() => {
        //             resolve(2 * num)
        //         }, 2000);
        //     })
        // }
        // // await 只能放到 async函数内部使用
        // async function testResult() {
        //     let result = await doubleAfter2seconds(30);
        //     console.log(result);
        // }
        // testResult()






        // 异常捕获用try catch

        // async getFaceResult() {
        //     try {
        //         let location = await this.getLocation(this.phoneNum);
        //         if (location.data.success) {
        //             let province = location.data.obj.province;
        //             let city = location.data.obj.city;
        //             let result = await this.getFaceList(province, city);
        //             if (result.data.success) {
        //                 this.faceList = result.data.obj;
        //             }
        //         }
        //     } catch (err) {
        //         console.log(err);
        //     }
        // }







        // async function foo() {
        //     var a = await new Promise((resolve) => {
        //         setTimeout(() => {
        //             resolve(1);
        //         }, 2000);
        //     });
        //     console.log(a); // 第2秒时输出: 1

        //     try {
        //         var b = await new Promise((resolve, reject) => {
        //             setTimeout(() => {
        //                 reject(2);
        //             }, 1000);
        //         })
        //     } catch (e) {
        //         console.log(e); // 第3秒时输出: 2
        //         console.log(b); // 第3秒时输出: undefined
        //     }

        //     // 函数暂停2秒后再继续执行
        //     var sleep = await new Promise((resolve) => {
        //         setTimeout(() => {
        //             resolve('sleep');
        //         }, 2000);
        //     });

        //     var c = await 3;
        //     console.log(c); // 第5秒时输出: 3

        //     // return 6;
        // }

        // foo();







        // function request(i) {
        //     return new Promise((resolve, reject) => {
        //         setTimeout(() => {
        //             // console.log(i, Math.random());

        //             // 捕获错误
        //             // reject( Math.random());

        //             // 成功结果
        //             resolve(Math.random());

        //         }, 1000);
        //     })

        // }

        // async function loop100(m) {
        //     for (var i = 0; i < m; i++) {
        //         // 捕获错误
        //         // try{
        //         //     await request(i)
        //         // }catch(e){
        //         //     console.log(e)
        //         // }

        //         // 成功结果
        //         console.log(await request(i));

        //     }
        // }
        // loop100(3);






        // function request(i){
        //     // return new Promise((resolve,reject)=>{
        //     //     setTimeout(() => {
        //     //         resolve();
        //     //         console.log(i,Math.random());
        //     //     }, 2000);
        //     // })
        //     return 2

        // }

        // async function loop100(m){
        //         console.log(await request(1));
        //         console.log(await request(1));
        //         await request(2);
        //         await request(3);

        // }
        // loop100(10);





        // async function s(){
        //     return new Promise((resolve,reject)=>{
        //         resolve(4);
        //     })

        // }

        // console.log(s())
        // s().then((res)=>{
        //     console.log(res)
        // })

        // async function s1(){
        //    return 3
        // }
        // console.log(s1())

        // s1().then((res)=>{
        //     console.log(res);
        // })





        //方法一
        // async function showData() {
        //     // 假装请求数据1
        //     var data1 = await new Promise((resolve) => {
        //         setTimeout(() => {
        //             console.log("data111")
        //             resolve('data11');
        //         }, 1000);
        //     });
        //     console.log(11)
        //     // 假装请求数据2且此请求依赖数据1
        //     var data2 = await new Promise((resolve) => {
        //         console.log(data1)
        //         setTimeout(() => {
        //             resolve('data22');
        //         }, 1000);
        //     });

        //     // 展示数据2
        //     console.log(data2);
        // }

        // showData();






        // 方法二
        async function getData() {
            // 假装请求数据1
            var data1 = await new Promise((resolve) => {
                setTimeout(() => {
                    resolve('data1');
                }, 1000);
            });

            // 假装请求数据2且此请求依赖数据1
            return new Promise((resolve) => {
                console.log(data1)
                setTimeout(() => {
                    resolve('data2');
                }, 1000);
            });
        }

        getData().then((v) => {
            console.log(v);
        });


    </script>
</head>

<body>

</body>

</html>